# name: benchmark/micro/RealNest/map_tests.benchmark
# description: get map testing benchmarks
# group: [RealNest]

name twitter hashtags
group real_nest

require json

load
create table wat as select * from read_json('~/RealNest/sample-data/100mib/daylight-openstreetmap-osm_features/data.jsonl')


# using the open street map database
# most popular keys
select keys, count(*) mentions from (select unnest(map_keys(tags)) as keys from wat) group by keys order by mentions desc limit 20;

# frequency number of keys per entrye
select len(map_keys(tags)) as num_keys, count(*) as frequency from wat group by num_keys order by frequency desc limit 10;

# how many entries are a building?
select count(*) from wat where list_contains(tags['building'], 'yes');

# most popular source for data
select tags['source'][1] as source, count(*) num from wat where source IS distinct from NULL group by source order by num desc limit 20;
