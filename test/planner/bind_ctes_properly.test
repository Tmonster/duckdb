# name: test/planner/bind_ctes_properly.test
# description: Bind CTE & filter pushdowns (https://github.com/duckdb/duckdb/issues/11042)
# group: [planner]

statement ok
CREATE OR REPLACE TABLE BaseData AS (
    SELECT
      '10' AS my_key,
      '20' AS parent_key,
      '30' AS payload
)
;

statement ok
WITH
Example AS (
    SELECT
        c.my_key,
        (c.parent_key IN (SELECT my_key FROM BaseData)) AS parentExists,
        p.my_key IS NOT NULL AS parentExists2,
    FROM BaseData AS c
    LEFT JOIN BaseData AS p ON c.parent_key = p.my_key
)
SELECT *
FROM Example
WHERE parentExists -- fails
;