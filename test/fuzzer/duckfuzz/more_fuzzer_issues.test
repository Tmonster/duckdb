# name: test/fuzzer/duckfuzz/more_fuzzer_issues.test
# description: Type mismatch in map concat
# group: [duckfuzz]

require tpch

require json

statement ok
create table all_types as select * exclude(small_enum, medium_enum, large_enum) from test_all_types() limit 0;

statement ok
call dbgen(sf=0.1);

statement ok
SELECT NULL FROM (SELECT ref_2.ps_availqty AS c0, ref_3.r_regionkey AS c1, json_object() AS c2, ref_5.o_shippriority AS c3, ref_1.ps_suppkey AS c4, ref_4.s_suppkey AS c5, ref_1.ps_suppkey AS c6, hex(CAST(CAST(NULL AS BLOB) AS BLOB)) AS c7, (SELECT o_shippriority FROM main.orders LIMIT 1 OFFSET 6) AS c8, ref_1.ps_partkey AS c9, add(CAST(CAST(NULL AS UBIGINT) AS UBIGINT), CAST(CAST(NULL AS UBIGINT) AS UBIGINT)) AS c10, ref_0.r_comment AS c11, ref_1.ps_suppkey AS c12 FROM main.region AS ref_0 INNER JOIN main.partsupp AS ref_1 ON ((ref_1.ps_comment !~~ ref_0.r_name)) INNER JOIN main.partsupp AS ref_2 ON (((SELECT n_regionkey FROM main.nation LIMIT 1 OFFSET 4) IS NULL)) INNER JOIN main.region AS ref_3 ON ((ref_0.r_name !~~ ref_2.ps_comment)) INNER JOIN main.supplier AS ref_4 INNER JOIN main.orders AS ref_5 ON (EXISTS(SELECT ref_5.o_orderstatus AS c0, ref_5.o_orderkey AS c1, ref_6.o_orderdate AS c2, ref_4.s_name AS c3, ref_4.s_comment AS c4 FROM main.orders AS ref_6 WHERE EXISTS(SELECT ref_4.s_acctbal AS c0, ref_5.o_clerk AS c1, ref_5.o_custkey AS c2, ref_7.s_address AS c3, ref_6.o_orderdate AS c4, ref_7.s_acctbal AS c5, (SELECT o_comment FROM main.orders LIMIT 1 OFFSET 3) AS c6, ref_5.o_custkey AS c7, ref_5.o_totalprice AS c8, ref_5.o_orderpriority AS c9, ref_4.s_comment AS c10, ref_7.s_name AS c11 FROM main.supplier AS ref_7 WHERE (CAST(NULL AS VARCHAR) !~~ CAST(NULL AS VARCHAR)) LIMIT 16))) ON ((ref_2.ps_supplycost = ref_5.o_totalprice)) WHERE ((ref_5.o_orderpriority ^@ ref_4.s_phone) OR (ref_4.s_phone ~~ ref_4.s_name))) AS subq_0 WHERE ((subq_0.c11 ~~ subq_0.c7) AND ((CAST(nullif(subq_0.c7, CAST(NULL AS VARCHAR)) AS VARCHAR) ~~* subq_0.c7) OR (subq_0.c11 ~~ subq_0.c7) OR ((SELECT ps_partkey FROM main.partsupp LIMIT 1 OFFSET 5) IS NULL))) LIMIT 64


#
#statement ok
#SELECT 44 AS c2 FROM
#	(SELECT
#		ref_0.dec_4_1 AS c0,
#	FROM main.all_types AS ref_0)
#AS subq_0
#WHERE
#	EXISTS(
#		SELECT
#			EXISTS(
#				SELECT NULL
#				FROM main.all_types AS ref_2
#				WHERE EXISTS
#					(SELECT NULL
#					WHERE ref_2."varchar")
#			)
#		WHERE
#			EXISTS(
#				SELECT ref_5.usmallint AS c0,
#				subq_0.c0 AS c1
#				FROM main.all_types AS ref_5
#			)
#	)