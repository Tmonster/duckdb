# name: test/fuzzer/duckfuzz/some_test.test
# description: Fuzzyduck issue #1128
# group: [duckfuzz]

statement ok
create table all_types as select * exclude(small_enum, medium_enum, large_enum) from test_all_types();

statement ok
pragma disable_optimizer;

statement ok
SELECT CASE  WHEN (1) THEN (CASE  WHEN (EXISTS(SELECT ref_7.date_array AS c0, ref_7."bigint" AS c1, ref_7."union" AS c2, ref_7.timestamptz_array AS c3, ref_7.struct_of_arrays AS c4, subq_3.c0 AS c5, subq_2.c3 AS c6, subq_2.c0 AS c7 FROM main.all_types AS ref_7 , (SELECT ref_8.array_of_structs AS c0 FROM main.all_types AS ref_8 WHERE ((ref_8."varchar" ~~ ref_7."varchar") OR (ref_7."varchar" ~~~ ref_8."varchar"))) AS subq_3 WHERE EXISTS(SELECT ref_10."varchar" AS c0, subq_3.c0 AS c1 FROM main.all_types AS ref_9 INNER JOIN main.all_types AS ref_10 ON ((ref_9."smallint" = ref_10."smallint")) WHERE EXISTS(SELECT ref_11.uint AS c0, ref_11."bigint" AS c1, subq_2.c0 AS c2, ref_11.bool AS c3, subq_3.c0 AS c4 FROM main.all_types AS ref_11 , (SELECT ref_12."map" AS c0 FROM main.all_types AS ref_12 , (SELECT ref_11.timestamp_array AS c0, subq_3.c0 AS c1, subq_3.c0 AS c2, ref_12.utinyint AS c3, ref_11.dec38_10 AS c4, ref_9.timestamp_ms AS c5, ref_12.dec_9_4 AS c6, (SELECT timestamp_ns FROM main.all_types LIMIT 1 OFFSET 2) AS c7, subq_3.c0 AS c8, ref_9.timestamp_array AS c9, ref_11."int" AS c10, subq_2.c1 AS c11, ref_13.date_array AS c12, ref_13.nested_int_array AS c13, (SELECT "bit" FROM main.all_types LIMIT 1 OFFSET 6) AS c14 FROM main.all_types AS ref_13 WHERE (18 IS NULL) LIMIT 148) AS subq_4 WHERE (ref_7."varchar" ^@ (SELECT "varchar" FROM main.all_types LIMIT 1 OFFSET 1)) LIMIT 31) AS subq_5 WHERE 1 LIMIT 120) LIMIT 151) LIMIT 109)) THEN (CAST(COALESCE(subq_2.c1, subq_2.c1) AS SMALLINT)) ELSE CAST(COALESCE(subq_2.c1, subq_2.c1) AS SMALLINT) END) ELSE CASE  WHEN (EXISTS(SELECT ref_7.date_array AS c0, ref_7."bigint" AS c1, ref_7."union" AS c2, ref_7.timestamptz_array AS c3, ref_7.struct_of_arrays AS c4, subq_3.c0 AS c5, subq_2.c3 AS c6, subq_2.c0 AS c7 FROM main.all_types AS ref_7 , (SELECT ref_8.array_of_structs AS c0 FROM main.all_types AS ref_8 WHERE ((ref_8."varchar" ~~ ref_7."varchar") OR (ref_7."varchar" ~~~ ref_8."varchar"))) AS subq_3 WHERE EXISTS(SELECT ref_10."varchar" AS c0, subq_3.c0 AS c1 FROM main.all_types AS ref_9 INNER JOIN main.all_types AS ref_10 ON ((ref_9."smallint" = ref_10."smallint")) WHERE EXISTS(SELECT ref_11.uint AS c0, ref_11."bigint" AS c1, subq_2.c0 AS c2, ref_11.bool AS c3, subq_3.c0 AS c4 FROM main.all_types AS ref_11 , (SELECT ref_12."map" AS c0 FROM main.all_types AS ref_12 , (SELECT ref_11.timestamp_array AS c0, subq_3.c0 AS c1, subq_3.c0 AS c2, ref_12.utinyint AS c3, ref_11.dec38_10 AS c4, ref_9.timestamp_ms AS c5, ref_12.dec_9_4 AS c6, (SELECT timestamp_ns FROM main.all_types LIMIT 1 OFFSET 2) AS c7, subq_3.c0 AS c8, ref_9.timestamp_array AS c9, ref_11."int" AS c10, subq_2.c1 AS c11, ref_13.date_array AS c12, ref_13.nested_int_array AS c13, (SELECT "bit" FROM main.all_types LIMIT 1 OFFSET 6) AS c14 FROM main.all_types AS ref_13 WHERE (18 IS NULL) LIMIT 148) AS subq_4 WHERE (ref_7."varchar" ^@ (SELECT "varchar" FROM main.all_types LIMIT 1 OFFSET 1)) LIMIT 31) AS subq_5 WHERE 1 LIMIT 120) LIMIT 151) LIMIT 109)) THEN (CAST(COALESCE(subq_2.c1, subq_2.c1) AS SMALLINT)) ELSE CAST(COALESCE(subq_2.c1, subq_2.c1) AS SMALLINT) END END AS c1, (SELECT uint FROM main.all_types LIMIT 1 OFFSET 2) AS c3 FROM (SELECT subq_1.c5 AS c0, subq_1.c4 AS c1, subq_1.c1 AS c2, subq_1.c8 AS c3, subq_1.c0 AS c5 FROM (SELECT ref_0.timestamp_tz AS c0, ref_0."bigint" AS c1, ref_0."smallint" AS c4, ref_0.timestamp_s AS c5, ref_0."varchar" AS c6, ref_0."int" AS c8, ref_0.dec38_10 AS c9 FROM main.all_types AS ref_0 WHERE ((ref_0.ubigint IS NULL) AND 1 AND (ref_0."varchar" ^@ ref_0."varchar") AND (ref_0."varchar" !~~ CAST(NULL AS VARCHAR)) AND EXISTS(SELECT subq_0.c0 AS c0, ref_1.time_tz AS c1, ref_1."bit" AS c2, subq_0.c0 AS c3, subq_0.c0 AS c4, ref_0."struct" AS c5, ref_1.varchar_array AS c6, ref_0.time_tz AS c7, ref_0."struct" AS c8, ref_1.date AS c9 FROM main.all_types AS ref_1 , (SELECT ref_1.usmallint AS c0 FROM main.all_types AS ref_2 WHERE ((ref_2."varchar" ^@ ref_0."varchar") AND (ref_1."varchar" ~~* ref_0."varchar"))) AS subq_0 WHERE 0 LIMIT 103))) AS subq_1 WHERE EXISTS(SELECT ref_3."float" AS c0, subq_1.c5 AS c1 FROM main.all_types AS ref_3 INNER JOIN main.all_types AS ref_4 ON ((ref_3.timestamptz_array IS NOT NULL)) WHERE EXISTS(SELECT ref_3.double_array AS c0, ref_3.dec_18_6 AS c1, ref_3.timestamp_ns AS c2, (SELECT "double" FROM main.all_types LIMIT 1 OFFSET 3) AS c3, ref_3.timestamp_array AS c4, ref_6.varchar_array AS c5 FROM main.all_types AS ref_5 INNER JOIN main.all_types AS ref_6 ON ((subq_1.c6 ~~* ref_5."varchar")) WHERE ((subq_1.c9 IS NULL) AND (ref_4."varchar" ^@ subq_1.c6) AND (ref_6."varchar" ~~ ref_3."varchar"))) LIMIT 76)) AS subq_2 WHERE ((current_schema() ~~~ current_database()) AND EXISTS(SELECT ref_14."union" AS c0, subq_2.c5 AS c1, subq_2.c2 AS c2, (SELECT favg("double") FROM main.all_types) AS c3 FROM main.all_types AS ref_14 WHERE (ref_14."varchar" ~~ ref_14."varchar") LIMIT 62)) LIMIT 160;