# name: test/optimizer/pushdown/pushdown_or.test
# description: Test Parquet With Pushing Down of OR Filters
# group: [pushdown]

require parquet

#statement ok
#PRAGMA enable_verification

statement ok
create table t0 as select range as a, range/2 as b, range/3 as c, range/4 as d from range(100);

statement ok
copy table t1 to 't0-whatever.parquet' (FORMAT PARQUET);
  

# cannot push down or filters that involve separate columns
query II
explain select * from t0 where a = 5 or b = 8 or c = 20 or d = 10;
----
physical_plan	<REGEX>:.*FILTER.*SEQ_SCAN.*

# can push down or filters if that are all on the same column
query II
explain select * from 't0-whatever.parquet' where a = 5 or a = 10 or a = 15 or a = 12;
----
physical_plan	<REGEX>:.*SEQ_SCAN.*Filters.*

# can push down two or filters combined by an and, given the or filters are both on the same column
query II
explain select * from t0 where (a = 5 or a = 10) and (b = 15 or b = 12);
----
physical_plan	<REGEX>:.*SEQ_SCAN.*Filters.*

query II
explain select * from t0 where (a = 5 or a = 10) and (b = 15 or b = 12);
----
physical_plan	<!REGEX>:.*FILTER.*SEQ_SCAN.*

# in filter can be pushed down
query II
explain select * from t0 where a in (1, 2, 3, 4, 10, 19, 25);
----
physical_plan	<REGEX>:.*SEQ_SCAN.*Filters.*

