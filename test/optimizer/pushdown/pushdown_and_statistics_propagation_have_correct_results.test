# name: test/optimizer/pushdown/pushdown_and_statistics_propagation_have_correct_results.test
# description: Test Table Filter Push Down
# group: [pushdown]

statement ok
pragma enable_verification

statement ok
create table t0 as select range%400000 a, range%400000 b from range(500000);

# just order by
query II
select * from (
	select *, row_number() OVER () as row_number from (
		SELECT * FROM t0 ORDER BY 1) ta
	) tb where b > 2 
order by a limit 2;
----
3	3	4
4	4	5


# just distinct
query II
select a, b from (
	select *, row_number() OVER () as row_number from (
		SELECT DISTINCT * FROM t0) ta
	) tb where b > 2 
order by a limit 2;
----
3	3
4	4


# distinct and order by
query II
select * from (
	select *, row_number() OVER () as row_number from (
		SELECT DISTINCT * FROM t0 ORDER BY 1) ta
	) tb where b > 2 
order by a limit 2;
----
3	3	4
4	4	5
